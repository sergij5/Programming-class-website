<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AI TRAINING</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Orbitron', sans-serif;
  background: url('21740054-95e4-4443-b4b6-f12d3012c666.png') center/cover no-repeat;
  color: #fff;
  text-shadow: 0 0 6px #000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  padding: 30px;


    background-image: url('img/space.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed; /* Фиксирует фон при прокрутке */

}

/* Заголовок */
h1 {
  font-size: 3rem;
  color: #ffcc00;
  text-transform: uppercase;
  text-shadow: 0 0 10px #ffcc00, 0 0 30px #ffaa00;
  margin-bottom: 20px;
}

/* Макет */
.wrapper {
  display: flex;
  gap: 40px;
  align-items: flex-start;
}

/* Игровая зона */
#boardWrap {
  display: grid;
  grid-template-columns: repeat(4, 90px);
  grid-template-rows: repeat(4, 90px);
  gap: 8px;
  background: rgba(0,0,0,0.6);
  border: 3px solid #00bfff;
  border-radius: 15px;
  box-shadow: 0 0 20px #00bfff inset;
  padding: 10px;
}

.cell {
  background: rgba(255,255,255,0.1);
  border: 2px solid #66ccff;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2rem;
  font-weight: bold;
  cursor: pointer;
  transition: 0.2s;
}
.cell:hover {
  background: rgba(100,200,255,0.3);
}
.cell:active {
  transform: scale(0.97);
}

/* Панель справа */
.panel {
  width: 300px;
  background: rgba(0, 10, 40, 0.7);
  border: 2px solid #00bfff;
  border-radius: 15px;
  padding: 20px;
  box-shadow: 0 0 25px #00aaff;
}

.panel h2 {
  font-size: 1.2rem;
  text-align: center;
  margin-bottom: 10px;
  color: #00ffff;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Кнопки */
button {
  width: 100%;
  margin-top: 8px;
  padding: 10px;
  font-family: 'Orbitron', sans-serif;
  font-size: 0.9rem;
  border-radius: 12px;
  border: 2px solid transparent;
  cursor: pointer;
  color: white;
  letter-spacing: 1px;
  transition: all 0.3s;
}

#newGameBtn {
  background: linear-gradient(180deg, #28a745, #1f7a1f);
  border-color: #00ff66;
  box-shadow: 0 0 10px #00ff66;
}
#newGameBtn:hover {
  background: linear-gradient(180deg, #33cc66, #1f7a1f);
}

#trainBtn {
  background: linear-gradient(180deg, #007bff, #0044aa);
  border-color: #00aaff;
  box-shadow: 0 0 10px #00aaff;
}
#trainBtn:hover {
  background: linear-gradient(180deg, #33aaff, #0044aa);
}

#resetBtn {
  background: linear-gradient(180deg, #c62828, #7f0000);
  border-color: #ff3333;
  box-shadow: 0 0 10px #ff0000;
}
#resetBtn:hover {
  background: linear-gradient(180deg, #ff4444, #a00000);
}

/* Прогресс и статистика */
.progress-bar {
  height: 10px;
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
  overflow: hidden;
  margin-top: 5px;
  border: 1px solid #00aaff;
}
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #00ffcc, #007bff);
  transition: width 0.3s;
}

#status {
  text-align: center;
  margin-top: 10px;
  padding: 10px;
  border-radius: 8px;
  background: rgba(0,50,100,0.6);
  border: 1px solid #00aaff;
  box-shadow: 0 0 10px #0099ff inset;
}

.stat-line {
  font-size: 0.85rem;
  color: #ccc;
  margin-top: 6px;
  text-align: center;
}
</style>
</head>

<body>
 <h1 class="text-3xl font-bold text-center mb-8">
    <img src="img/Cool Text - AI Training 492436408948864 1.png" alt="AI TRAINING" class="inline-block h-8 mr-3">

</h1>

  <div class="wrapper">
    <div id="boardWrap"></div>

    <div class="panel">
      <h2>Performance Metrics</h2>
      <div id="status">Your move (X)</div>

      <div class="stat-line" id="stats">Wins: 0 | Draws: 0 | Losses: 0 | Accuracy: 0%</div>

      <div class="mt-3">
        <div class="flex justify-between text-xs mb-1">
          <span>Training progress</span>
          <span id="progressText">0%</span>
        </div>
        <div class="progress-bar">
          <div id="progressFill" class="progress-fill" style="width:0%"></div>
        </div>
      </div>

      <button id="newGameBtn">Restart</button>
      <button id="resetBtn">Reset learning</button>
      <button id="trainBtn">Launch learning algorithm</button>
    </div>
  </div>

<div>
 <img src="img/uranus.gif">
</div>


<script>
// ==== оригинальная логика ====
const SIZE = 4;
const WIN_PATTERNS = [
  [0,1,2,3],[4,5,6,7],[8,9,10,11],[12,13,14,15],
  [0,4,8,12],[1,5,9,13],[2,6,10,14],[3,7,11,15],
  [0,5,10,15],[3,6,9,12]
];

let gameState = { grid: Array(16).fill(null), current: 'X', active: true };
const boardWrap = document.getElementById('boardWrap');
const statusEl = document.getElementById('status');
const statsEl = document.getElementById('stats');
const progressText = document.getElementById('progressText');
const progressFill = document.getElementById('progressFill');

const alpha = 0.3, gamma = 0.9, epsilon = 0.2;
let Q = {};
let trainingStats = { wins:0, draws:0, losses:0, accurateMoves:0, totalMoves:0 };

function stateKey(s){ return s.map(v=>v===null?'-':v).join(''); }
function availableActions(s){ return s.map((v,i)=>v===null?i:null).filter(x=>x!==null); }

function chooseAction(key,actions,train=true){
  if(train && Math.random()<epsilon) return actions[Math.floor(Math.random()*actions.length)];
  const entry=Q[key]||{}; let max=-Infinity,best=[];
  for(const a of actions){const v=entry[a]||0;if(v>max){max=v;best=[a];}else if(v===max){best.push(a);}}
  if(!best.length)best=actions; return best[Math.floor(Math.random()*best.length)];
}
function updateQ(prev,a,r,next){
  const pk=stateKey(prev), nk=stateKey(next);
  const ov=(Q[pk]&&Q[pk][a])?Q[pk][a]:0;
  const na=availableActions(next);
  let maxNext=0;
  if(na.length){const ne=Q[nk]||{};maxNext=Math.max(...na.map(x=>ne[x]||0));}
  const nv=ov+alpha*(r+gamma*maxNext-ov);
  if(!Q[pk])Q[pk]={}; Q[pk][a]=nv;
}
function checkEnd(g){
  for(const p of WIN_PATTERNS){const[a,b,c,d]=p;
    if(g[a]&&g[a]===g[b]&&g[a]===g[c]&&g[a]===g[d])return{finished:true,winner:g[a]};}
  if(!g.includes(null))return{finished:true,winner:'draw'};
  return{finished:false};
}
function applyMove(i,sym){
  if(!gameState.active||gameState.grid[i]!==null)return false;
  gameState.grid[i]=sym; drawBoard(); return true;
}
function humanMove(i){
  if(!gameState.active||gameState.current!=='X')return;
  if(!applyMove(i,'X'))return;
  const r=checkEnd(gameState.grid);
  if(r.finished)return endGame(r.winner);
  gameState.current='O';
  statusEl.textContent='AI is thinking...';
  setTimeout(agentMove,400);
}
function agentMove(){
  if(!gameState.active)return;
  const grid=gameState.grid.slice(), actions=availableActions(grid);
  if(!actions.length)return endGame('draw');
  const key=stateKey(grid);
  const action=chooseAction(key,actions,false);
  applyMove(action,'O');
  const r=checkEnd(gameState.grid);
  if(r.finished)return endGame(r.winner);
  gameState.current='X';
  statusEl.textContent='Your move (X)';
}
function endGame(w){
  gameState.active=false;
  if(w==='draw'){statusEl.textContent='Draw!';}
  else if(w==='X'){statusEl.textContent='You win!';}
  else{statusEl.textContent='AI wins!';}
}
function drawBoard(){
  boardWrap.innerHTML='';
  for(let i=0;i<16;i++){
    const cell=document.createElement('div');
    cell.className='cell';
    cell.textContent=gameState.grid[i]||'';
    cell.style.color=gameState.grid[i]==='X'?'#3af':'#f33';
    cell.addEventListener('click',()=>humanMove(i));
    boardWrap.appendChild(cell);
  }
}
function resetGame(){
  gameState.grid=Array(16).fill(null);
  gameState.current='X';
  gameState.active=true;
  statusEl.textContent='Your move (X)';
  drawBoard();
}
function train(episodes){
  let done=0;
  function run(){
    let state=Array(16).fill(null);
    let turn=Math.random()<0.5?'X':'O';
    let transitions=[];
    while(true){
      if(turn==='O'){
        const key=stateKey(state);
        const acts=availableActions(state);
        if(!acts.length)break;
        const act=chooseAction(key,acts,true);
        const prev=state.slice();
        state[act]='O';
        transitions.push({prevState:prev,action:act});
        const res=checkEnd(state);
        if(res.finished){
          let rew=0;
          if(res.winner==='O'){rew=1;trainingStats.wins++;}
          else if(res.winner==='X'){rew=-1;trainingStats.losses++;}
          else{rew=0.5;trainingStats.draws++;}
          for(const t of transitions)updateQ(t.prevState,t.action,rew,state);
          break;
        }
      }else{
        const acts=availableActions(state);
        if(!acts.length)break;
        const ra=acts[Math.floor(Math.random()*acts.length)];
        state[ra]='X';
        const res=checkEnd(state);
        if(res.finished){
          let rew=0;
          if(res.winner==='O'){rew=1;trainingStats.wins++;}
          else if(res.winner==='X'){rew=-1;trainingStats.losses++;}
          else{rew=0.5;trainingStats.draws++;}
          for(const t of transitions)updateQ(t.prevState,t.action,rew,state);
          break;
        }
      }
      turn=turn==='X'?'O':'X';
    }
    done++;
    if(done%100===0||done===episodes){
      const prog=Math.round((done/episodes)*100);
      progressText.textContent=prog+'%';
      progressFill.style.width=prog+'%';
    }
    if(done<episodes)setTimeout(run,0);
    else{updateStats();statusEl.textContent='Training complete! Play vs AI.';}
  }
  run();
}
function updateStats(){
  const acc=trainingStats.totalMoves>0?
    Math.round((trainingStats.accurateMoves/trainingStats.totalMoves)*100):0;
  statsEl.textContent=`Wins: ${trainingStats.wins} | Draws: ${trainingStats.draws} | Losses: ${trainingStats.losses} | Accuracy: ${acc}%`;
}

document.getElementById('newGameBtn').addEventListener('click',resetGame);
document.getElementById('trainBtn').addEventListener('click',()=>{statusEl.textContent='Training (25,000 games)...';train(25000);});
document.getElementById('resetBtn').addEventListener('click',()=>{
  Q={};
  trainingStats={wins:0,draws:0,losses:0,accurateMoves:0,totalMoves:0};
  progressFill.style.width='0%';
  progressText.textContent='0%';
  statsEl.textContent='Wins: 0 | Draws: 0 | Losses: 0 | Accuracy: 0%';
});

drawBoard();
</script>
</body>
</html>
